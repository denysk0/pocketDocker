@startuml
skinparam classAttributeIconSize 0

package internal.cli {
  class CLICommand {
    +Execute(args []string) error
  }
  class RunCommand
  class StopCommand
  class PsCommand
  class PullCommand
  class LogsCommand

  CLICommand <|-- RunCommand
  CLICommand <|-- StopCommand
  CLICommand <|-- PsCommand
  CLICommand <|-- PullCommand
  CLICommand <|-- LogsCommand
}

package internal.runtime {
  class Container {
    -id string
    -name string
    -image Image
    -pid int
    -cgroupPath string
    +Start(config ContainerConfig) error
    +Stop() error
    +Status() ContainerStatus
  }
  class ContainerConfig {
    +ImagePath string
    +MemoryLimit string
    +CpuShares int
    +Command []string
  }
  class CgroupManager {
    +Apply(containerID string, config ContainerConfig) error
    +Cleanup(containerID string) error
  }
  class Isolator {
    +SetupNamespaces(config ContainerConfig) error
    +Teardown() error
  }

  Container ..> ContainerConfig
  Container o-- CgroupManager
  Container o-- Isolator
}

package internal.store {
  class Store {
    -db *sql.DB
    +SaveContainer(c Container) error
    +ListContainers() ([]Container, error)
    +DeleteContainer(id string) error
  }
  class Image
  Store o-- "0..*" Container
  Store o-- "0..*" Image
}

package internal.logging {
  class Logger {
    +Capture(containerID string, pid int) error
    +Tail(containerID string) (io.Reader, error)
  }
}

internal.cli.RunCommand ..> internal.runtime.Container
internal.cli.RunCommand ..> internal.store.Store
internal.cli.PullCommand ..> internal.store.Store
internal.cli.LogsCommand ..> internal.logging.Logger
internal.cli.PsCommand ..> internal.store.Store
internal.cli.StopCommand ..> internal.runtime.Container